<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>DedSec Phone — Pixel UI</title>
<style>
:root{
  --bg:#000;
  --pink:#ff22c8;
  --neon:#00ffcc;
  --muted:#9aa0a6;
  --panel: rgba(255,255,255,0.03);
  --mono: 'Courier New', monospace;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:var(--mono);background:var(--bg);color:#e6e6e6}
.container{max-width:420px;margin:6px auto;border-radius:14px;overflow:hidden;background:linear-gradient(180deg,#050505,#0a0a0a);box-shadow:0 20px 50px rgba(0,0,0,.8)}
.screen{padding:12px;min-height:780px;position:relative}
/* Wallpaper: recreate skull mosaic + big logo */
.wallpaper{position:absolute;inset:0;background-color:#000;background-image:
  radial-gradient(circle at 10% 8%, rgba(255,255,255,0.02) 0 2px, transparent 2px 6px),
  repeating-linear-gradient(0deg, rgba(255,255,255,0.01) 0 1px, transparent 1px 3px);
  z-index:0;}
.wallpaper::before{content:'';position:absolute;inset:60px 18px 120px 18px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="800" height="800"><g fill="none" stroke="%23000" stroke-width="10"></g><text x="50" y="300" font-family="monospace" font-size="120" fill="%23FFFFFF" opacity="0.06">DEDSEC</text></svg>');background-position:center;background-repeat:no-repeat;background-size:cover;opacity:.28}
.topbar{position:relative;z-index:2;display:flex;align-items:center;gap:10px}
.xpbar{flex:1;height:18px;background:#111;border-radius:6px;padding:2px;display:flex;align-items:center;gap:8px}
.xpinner{height:12px;background:linear-gradient(90deg,var(--pink),#9b00ff);border-radius:6px;flex:1;position:relative;overflow:hidden}
.xp-label{font-size:12px;padding-left:8px;color:#fff;font-weight:700}
.stats{margin-left:10px;font-size:12px;color:var(--muted)}
.header-row{display:flex;align-items:center;justify-content:space-between;margin:10px 0}
/* Grid */
.apps{position:relative;z-index:2;display:grid;grid-template-columns:repeat(4,1fr);gap:14px;padding:18px}
.app{display:flex;flex-direction:column;align-items:center;text-align:center;font-size:12px}
.icon{width:68px;height:68px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.04);box-shadow:0 6px 14px rgba(0,0,0,0.8)}
.icon img{width:56px;height:56px;display:block}
.label{margin-top:8px;max-width:74px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
/* bottom dock */
.dock{display:flex;gap:18px;justify-content:space-around;padding:10px 24px;position:relative;z-index:2}
.dock .icon{width:68px;height:68px}
/* modal app window */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(0,0,0,0.45),rgba(0,0,0,0.7));z-index:80}
.modal.open{display:flex}
.card{width:95%;max-width:420px;height:86vh;background:linear-gradient(180deg,#070707,#0f0f0f);border-radius:12px;padding:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.04)}
.card header{display:flex;align-items:center;justify-content:space-between}
.btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:8px;color:#ddd;cursor:pointer}
.cam-wrap{margin-top:10px}
video{width:100%;height:auto;border-radius:8px;background:#000}
.log{margin-top:10px;padding:8px;background:rgba(255,255,255,0.02);border-radius:8px;max-height:28vh;overflow:auto}
.small{font-size:12px;color:var(--muted)}
/* XP skull badges */
.skulls{display:flex;gap:6px;align-items:center}
.skull{width:22px;height:22px;border-radius:50%;background:#fff;color:#000;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:12px}
/* responsive tweaks */
@media (max-width:420px){.apps{gap:10px;padding:12px}}
</style>
</head>
<body>
<div class="container">
  <div class="screen">
    <div class="wallpaper" aria-hidden></div>
    <div class="topbar">
      <div class="xpbar" style="width:74%">
        <div class="xpinner" id="xpInner" style="width:60%"></div>
        <div class="xp-label">8348822/10048822</div>
      </div>
      <div class="skulls"><div class="skull">☠</div><div class="skull">☠</div><div class="skull">☠</div></div>
      <div class="stats">+8</div>
    </div>

    <div class="header-row">
      <div class="small">¥185903</div>
      <div class="small">online • 4G • 83%</div>
    </div>

    <div class="apps" id="homeGrid">
      <!-- icons recreated to look like screenshot -> SVG icons embedded for style -->
      <div class="app" data-app="maps"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%23ffffff' opacity='0.12'/><path d='M8 36 L24 20 L40 28 L48 16' stroke='%2300aaff' stroke-width='3' fill='none' stroke-linecap='round' stroke-linejoin='round'/></svg>"/></div><div class="label">Nudle Maps</div></div>

      <div class="app" data-app="dedsec"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%23ffffff' opacity='0.06'/><g transform='translate(6,6)'><circle cx='22' cy='18' r='8' fill='%23000000'/><path d='M0 36 L44 36' stroke='%23fff' stroke-width='4' opacity='0.06'/></g></svg>"/></div><div class="label">DedSec App</div></div>

      <div class="app" data-app="research"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%23000000' /><text x='7' y='34' font-family='monospace' font-size='22' fill='%23fff' opacity='0.9'>R</text></svg>"/></div><div class="label">./Research</div></div>

      <div class="app" data-app="car"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%23001111' /><path d='M6 34 q8 -12 22 -12 q14 0 22 12' stroke='%23fff' stroke-width='2' fill='%23001111' opacity='0.9' /></svg>"/></div><div class="label">Car on Demand</div></div>

      <div class="app" data-app="shop"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%231a1a1a' /><path d='M14 12 h28 v28 h-28 z' stroke='%23fff' stroke-width='2' opacity='0.06'/></svg>"/></div><div class="label">App Shop</div></div>

      <div class="app" data-app="media"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%23111111' /><path d='M20 18 L36 28 L20 38 z' fill='%23ff66cc' opacity='0.9'/></svg>"/></div><div class="label">Midia Player</div></div>

      <div class="app" data-app="driver"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%23111111' /><text x='12' y='34' font-family='monospace' font-size='22' fill='%23ffd166' opacity='0.95'>D</text></svg>"/></div><div class="label">Driver SF</div></div>

      <div class="app" data-app="scout"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='56' height='56'><rect width='56' height='56' rx='8' fill='%23111111' /><circle cx='28' cy='28' r='10' fill='%2300ff66' opacity='0.6'/></svg>"/></div><div class="label">ScoutX</div></div>

    </div>

    <div class="dock">
      <div class="app" data-app="camera"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='60' height='60'><rect width='60' height='60' rx='12' fill='%23111111'/><circle cx='30' cy='30' r='12' fill='%2300aaff' opacity='0.8'/></svg>"/></div><div class="label">Camera</div></div>
      <div class="app" data-app="knowit"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='60' height='60'><rect width='60' height='60' rx='12' fill='%23111111'/><text x='18' y='36' font-family='monospace' font-size='18' fill='%23fff'>i</text></svg>"/></div><div class="label">Know-It-All</div></div>
      <div class="app" data-app="phone"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='60' height='60'><rect width='60' height='60' rx='12' fill='%23111111'/><path d='M20 14 q8 12 20 0' stroke='%23fff' stroke-width='2'/></svg>"/></div><div class="label">Phone</div></div>
      <div class="app" data-app="multi"><div class="icon"><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='60' height='60'><rect width='60' height='60' rx='12' fill='%23111111'/><rect x='10' y='14' width='40' height='12' rx='3' fill='%23ffd166' opacity='0.9'/></svg>"/></div><div class="label">Multiplayer</div></div>
    </div>

  </div>
</div>

<!-- Modal -->
<div class="modal" id="modal" aria-hidden>
  <div class="card">
    <header>
      <div id="appTitle" style="font-weight:900"></div>
      <div><button class="btn" id="closeBtn">CLOSE</button></div>
    </header>
    <div id="appBody"></div>
  </div>
</div>

<script>
// --- improved camera heuristics and more robust starter apps ---
const apps = document.querySelectorAll('.app');
const modal = document.getElementById('modal');
const appTitle = document.getElementById('appTitle');
const appBody = document.getElementById('appBody');
const closeBtn = document.getElementById('closeBtn');
let currentStream = null; let currentVideo = null; let workingCanvas=null; let wctx=null; let prevFrame=null;

apps.forEach(a=> a.addEventListener('click', ()=> openApp(a.dataset.app)));
closeBtn.addEventListener('click', closeApp);

function openApp(name){ modal.setAttribute('aria-hidden','false'); modal.classList.add('open'); appTitle.textContent = name.toUpperCase(); appBody.innerHTML='';
  if(name==='profiler' || name==='camera' || name==='car' || name==='traffic') loadCameraApp(name);
  else if(name==='dedsec') loadDedsec();
  else loadSimpleApp(name);
}
function closeApp(){ modal.setAttribute('aria-hidden','true'); modal.classList.remove('open'); stopCurrentStream(); appBody.innerHTML=''; }

async function startCamera(constraints={video:{facingMode:'environment',width:640,height:480}, audio:false}){
  try{ const s = await navigator.mediaDevices.getUserMedia(constraints); currentStream = s; return s; }catch(e){ throw e }
}
function attachVideo(container){
  if(!currentStream) return; currentVideo = document.createElement('video'); currentVideo.autoplay=true; currentVideo.playsInline=true; currentVideo.muted=true; currentVideo.srcObject=currentStream; container.appendChild(currentVideo);
  workingCanvas = document.createElement('canvas'); workingCanvas.width=320; workingCanvas.height=240; wctx = workingCanvas.getContext('2d');
}
function stopCurrentStream(){ if(currentStream){ currentStream.getTracks().forEach(t=>t.stop()); currentStream=null } if(currentVideo){ currentVideo.srcObject=null; currentVideo.remove(); currentVideo=null } prevFrame=null }

function sample(){ if(!wctx || !currentVideo) return null; try{ wctx.drawImage(currentVideo,0,0,workingCanvas.width,workingCanvas.height); return wctx.getImageData(0,0,workingCanvas.width,workingCanvas.height); }catch(e){ return null } }

// more robust human detector: combine skin heuristic + blob motion and require sustained detection across multiple samples
function detectHumanStable(samples=3){ let hits=0; for(let i=0;i<samples;i++){ const img = sample(); if(!img) continue; if(detectHuman(img)) hits++; }
 return hits>=2; }
function detectHuman(img){ const d=img.data; let skin=0, motion=0; if(!prevFrame) prevFrame=new Uint8ClampedArray(d); for(let i=0;i<d.length;i+=4){ const r=d[i],g=d[i+1],b=d[i+2]; if(r>95 && g>40 && b>20 && r>g && r>b && (r-g)>15) skin++; const diff = Math.abs(r-prevFrame[i]) + Math.abs(g-prevFrame[i+1]) + Math.abs(b-prevFrame[i+2]); if(diff>70) motion++; }
 const px = d.length/4; const sr=skin/px; const mr=motion/px; prevFrame.set(d); return (sr>0.007 && mr>0.015) || mr>0.04; }

// car detection: look for large contiguous motion and bright highlights
function detectCar(img){ const d=img.data; let motion=0, bright=0; if(!prevFrame) prevFrame=new Uint8ClampedArray(d); for(let i=0;i<d.length;i+=4){ const r=d[i],g=d[i+1],b=d[i+2]; const lum = 0.2126*r+0.7152*g+0.0722*b; if(lum>160) bright++; const diff = Math.abs(r-prevFrame[i]) + Math.abs(g-prevFrame[i+1]) + Math.abs(b-prevFrame[i+2]); if(diff>90) motion++; }
 const px = d.length/4; prevFrame.set(d); return (motion/px>0.03 && bright/px>0.02) || motion/px>0.06; }

function detectTrafficLight(img){ const d=img.data; let r=0,g=0; for(let i=0;i<d.length;i+=4){ const R=d[i],G=d[i+1],B=d[i+2]; if(R>160 && R>G+50 && R>B+50) r++; if(G>160 && G>R+50 && G>B+50) g++; }
 const px=d.length/4; if(r/px>0.0025) return 'red'; if(g/px>0.0025) return 'green'; return null }

// Bootstrapped camera-based app loader
async function loadCameraApp(name){ appBody.innerHTML = `<div style="font-weight:800;margin-top:6px">${name.toUpperCase()}</div><div class="small">Camera-based toy — no recognition, all simulated.</div><div class='cam-wrap' id='camWrap'></div><div style='margin-top:8px'><button class='btn' id='startCam'>Start</button> <button class='btn' id='actionBtn'>Action</button> <button class='btn' id='stopCam'>Stop</button></div><div class='log' id='log'>Ready.</div>`;
  const camWrap = document.getElementById('camWrap'); const log = document.getElementById('log');
  document.getElementById('startCam').onclick = async ()=>{ log.textContent='Starting camera...'; try{ await startCamera(); attachVideo(camWrap); log.textContent='Camera live. Wait ~1s for warmup.'; setTimeout(()=>log.textContent='Ready to scan.',900); }catch(e){ log.textContent='Camera error: '+e.message } };
  document.getElementById('stopCam').onclick = ()=>{ stopCurrentStream(); camWrap.innerHTML=''; log.textContent='Stopped.' };
  document.getElementById('actionBtn').onclick = async ()=>{
    if(!currentVideo){ log.textContent='Start camera first.'; return; }
    log.textContent='Scanning...'; // sample multiple frames for stability
    let frames=[]; for(let i=0;i<6;i++){ const img=sample(); if(img) frames.push(img); await new Promise(r=>setTimeout(r,120)); }
    // human
    const foundHuman = frames.some(f=> detectHuman(f));
    const foundCar = frames.some(f=> detectCar(f));
    const foundLight = frames.map(f=> detectTrafficLight(f)).find(x=>x);
    if(name==='camera' || name==='profiler'){
      if(foundHuman){ const prof = makeFakeProfile(); log.innerHTML = formatProfile(prof);} else { log.textContent='No human detected. Try pointing at a person and move slightly.' }
    }
    if(name==='car'){
      if(foundCar){ const id='CAR-'+Math.random().toString(36).slice(2,10).toUpperCase(); log.innerHTML=`Vehicle found: <strong>${id}</strong><br/><button class='btn' onclick="fakeCar('${id}','start')">Remote Start</button> <button class='btn' onclick="fakeCar('${id}','left')">Turn Left</button> <div style='margin-top:6px' class='small'>All actions are visual simulations.</div>` } else { log.textContent='No car-like object detected.' }
    }
    if(name==='traffic'){
      if(foundLight){ log.innerHTML=`Traffic light: <strong>${foundLight.toUpperCase()}</strong><div style='margin-top:6px'><button class='btn' onclick="fakeLight('forceGreen')">Force Green</button> <button class='btn' onclick="fakeLight('forceRed')">Force Red</button></div>` } else log.textContent='No traffic light detected.'
    }
  };
}

function loadDedsec(){ appBody.innerHTML=`<div style='font-weight:900'>DEDSEC HUB</div><div class='small'>Home of the visual toys. Pick an app.</div><div style='margin-top:10px' class='log'>Replica UI loaded – camera features simulate detection using pixel heuristics. Nothing leaves your device.</div>` }
function loadSimpleApp(name){ appBody.innerHTML = `<div style='font-weight:900'>${name.toUpperCase()}</div><div class='small'>This is a starter mock for ${name}. Tell me which app to fully flesh out next.</div><div class='log'>Examples: Profiler -> polished ID card, Car -> animated HUD, Traffic -> timeline demo.</div>` }

// fake actions used in injected markup
window.fakeCar = function(id,action){ const el = document.querySelector('.log'); if(el) el.innerHTML += `<div style='margin-top:8px'>Simulating ${action} on <strong>${id}</strong> <span style='color:#8f8'>(visual)</span></div>` }
window.fakeLight = function(cmd){ const el=document.querySelector('.log'); if(el) el.innerHTML += `<div style='margin-top:8px'>${cmd} executed (local visual only)</div>` }

// Fake profile generator and formatter
function makeFakeProfile(){ const first=['Alex','Sam','Taylor','Jordan','Riley','Morgan','Casey','Kai','Devon','Sky']; const last=['Hart','Mills','Rey','Nguyen','Ortiz','Vega','Blake','Stone','Rowe','Khan']; const jobs=['Barista','Coder','Delivery Rider','Artist','Paramedic','Student','Teacher','Bartender','Mechanic','DJ']; const traits=['Cautious','Outgoing','Methodical','Chaotic','Charismatic','Secretive']; const crimes=['None','Petty theft (2016)','Trespassing (2019)','Public disturbance (2020)','Fraud allegation (2017)']; const p={name:rand(first)+' '+rand(last),id:'ID-'+Math.random().toString(36).slice(2,10).toUpperCase(),job:rand(jobs),traits:rand(traits),crimes:rand(crimes),hobbies:rand(['Skating','Photography','Gaming','Gardening','Cooking']),income:'$'+(Math.floor(15000+Math.random()*90000)).toLocaleString()}; return p }
function formatProfile(p){ return `<div style='font-weight:800'>${p.name}</div><div class='small'>ID: ${p.id}</div><div style='margin-top:6px'>Job: ${p.job}<br/>Traits: ${p.traits}<br/>Crimes: ${p.crimes}<br/>Hobbies: ${p.hobbies}<br/>Income: ${p.income}</div><div style='margin-top:8px' class='small'>This is fake data for entertainment only.</div>` }
function rand(a){ return a[Math.floor(Math.random()*a.length)] }

</script>
</body>
</html>
